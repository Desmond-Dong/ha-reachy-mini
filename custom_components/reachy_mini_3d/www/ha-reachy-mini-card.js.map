{"version":3,"file":"ha-reachy-mini-card.js","sources":["../../../src/ha-reachy-mini-card.js"],"sourcesContent":["// Reachy Mini 3D Card - Direct Daemon Connection\n// Version: 3.1.0\n// https://github.com/Desmond-Dong/ha-reachy-mini-card\n\n/* global OrbitControls */\n\n(function () {\n  'use strict';\n\n  // Ë¢´Âä®ÂÖ≥ËäÇÂêçÁß∞Â∏∏Èáè\n  const PASSIVE_JOINT_NAMES = [\n    'passive_1_x', 'passive_1_y', 'passive_1_z',\n    'passive_2_x', 'passive_2_y', 'passive_2_z',\n    'passive_3_x', 'passive_3_y', 'passive_3_z',\n    'passive_4_x', 'passive_4_y', 'passive_4_z',\n    'passive_5_x', 'passive_5_y', 'passive_5_z',\n    'passive_6_x', 'passive_6_y', 'passive_6_z',\n    'passive_7_x', 'passive_7_y', 'passive_7_z',\n  ];\n\n  // ÈÖçÁΩÆÁºñËæëÂô® - ÂøÖÈ°ªÂú®‰∏ªÂç°‰πãÂâçÂÆö‰πâÂíåÊ≥®ÂÜå\n  class ReachyMini3DCardEditor extends HTMLElement {\n    constructor() {\n      super();\n      this.attachShadow({ mode: 'open' });\n    }\n\n    setConfig(config) {\n      this._config = config;\n      this.render();\n    }\n\n    render() {\n      const config = this._config || {};\n\n      this.shadowRoot.innerHTML = `\n      <style>\n        :host { display: block; }\n        .form-row {\n          display: flex;\n          flex-direction: column;\n          margin-bottom: 12px;\n        }\n        label {\n          font-size: 14px;\n          font-weight: 500;\n          margin-bottom: 4px;\n          color: var(--primary-text-color);\n        }\n        input[type=\"text\"],\n        input[type=\"number\"] {\n          width: 100%;\n          padding: 8px;\n          border: 1px solid var(--primary-color);\n          border-radius: 4px;\n          background: var(--card-background-color);\n          color: var(--primary-text-color);\n          box-sizing: border-box;\n        }\n        input[type=\"text\"]:focus,\n        input[type=\"number\"]:focus {\n          outline: none;\n          border-color: var(--accent-color);\n        }\n        .checkbox-row {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n        }\n        .checkbox-row input[type=\"checkbox\"] {\n          width: auto;\n          margin: 0;\n        }\n        .checkbox-row label {\n          margin-bottom: 0;\n          flex: 1;\n        }\n        .hint {\n          font-size: 12px;\n          color: var(--secondary-text-color);\n          margin-top: 4px;\n        }\n        .section-title {\n          font-size: 13px;\n          font-weight: 600;\n          color: var(--primary-text-color);\n          margin-top: 16px;\n          margin-bottom: 8px;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n      </style>\n\n      <div class=\"section-title\">Connection</div>\n\n      <div class=\"form-row\">\n        <label for=\"host\">Daemon Host</label>\n        <input\n          id=\"host\"\n          type=\"text\"\n          value=\"${config.daemon_host || 'localhost'}\"\n          placeholder=\"localhost or IP address\"\n        />\n        <div class=\"hint\">Reachy Mini daemon hostname or IP address</div>\n      </div>\n\n      <div class=\"form-row\">\n        <label for=\"port\">Daemon Port</label>\n        <input\n          id=\"port\"\n          type=\"number\"\n          value=\"${config.daemon_port || 8000}\"\n          placeholder=\"8000\"\n        />\n        <div class=\"hint\">WebSocket port (default: 8000)</div>\n      </div>\n\n      <div class=\"section-title\">Display</div>\n\n      <div class=\"form-row\">\n        <label for=\"height\">Card Height (px)</label>\n        <input\n          id=\"height\"\n          type=\"number\"\n          value=\"${config.height || 400}\"\n          placeholder=\"400\"\n        />\n        <div class=\"hint\">Height of the card in pixels</div>\n      </div>\n\n      <div class=\"form-row\">\n        <label for=\"background\">Background Color</label>\n        <input\n          id=\"background\"\n          type=\"text\"\n          value=\"${config.background_color || '#f5f5f5'}\"\n          placeholder=\"#f5f5f5\"\n        />\n        <div class=\"hint\">Background color (hex code)</div>\n      </div>\n\n      <div class=\"form-row\">\n        <label for=\"camera_distance\">Camera Distance</label>\n        <input\n          id=\"camera_distance\"\n          type=\"number\"\n          step=\"0.1\"\n          value=\"${config.camera_distance || 0.5}\"\n          placeholder=\"0.5\"\n        />\n        <div class=\"hint\">Initial camera distance (0.2 - 1.5)</div>\n      </div>\n\n      <div class=\"section-title\">Features</div>\n\n      <div class=\"checkbox-row\">\n        <input type=\"checkbox\" id=\"enable_passive\" ${config.enable_passive_joints !== false ? 'checked' : ''}>\n        <label for=\"enable_passive\">Enable Passive Joints</label>\n      </div>\n      <div class=\"hint\">Show Stewart platform passive joints (requires daemon support)</div>\n\n      <div class=\"checkbox-row\">\n        <input type=\"checkbox\" id=\"enable_pose\" ${config.enable_head_pose !== false ? 'checked' : ''}>\n        <label for=\"enable_pose\">Enable Head Pose</label>\n      </div>\n      <div class=\"hint\">Use 4x4 pose matrix for head positioning</div>\n\n      <div class=\"checkbox-row\">\n        <input type=\"checkbox\" id=\"enable_grid\" ${config.enable_grid !== false ? 'checked' : ''}>\n        <label for=\"enable_grid\">Show Grid</label>\n      </div>\n      <div class=\"hint\">Display ground grid helper</div>\n    `;\n\n      // ÁõëÂê¨ËæìÂÖ•ÂèòÂåñ\n      this.shadowRoot.getElementById('host').addEventListener('change', (e) => {\n        this._config = { ...this._config, daemon_host: e.target.value };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('port').addEventListener('change', (e) => {\n        this._config = { ...this._config, daemon_port: parseInt(e.target.value) };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('height').addEventListener('change', (e) => {\n        this._config = { ...this._config, height: parseInt(e.target.value) };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('background').addEventListener('change', (e) => {\n        this._config = { ...this._config, background_color: e.target.value };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('camera_distance').addEventListener('change', (e) => {\n        this._config = { ...this._config, camera_distance: parseFloat(e.target.value) };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('enable_passive').addEventListener('change', (e) => {\n        this._config = { ...this._config, enable_passive_joints: e.target.checked };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('enable_pose').addEventListener('change', (e) => {\n        this._config = { ...this._config, enable_head_pose: e.target.checked };\n        this.dispatchConfig();\n      });\n\n      this.shadowRoot.getElementById('enable_grid').addEventListener('change', (e) => {\n        this._config = { ...this._config, enable_grid: e.target.checked };\n        this.dispatchConfig();\n      });\n    }\n\n    dispatchConfig() {\n      const event = new CustomEvent('config-changed', {\n        detail: { config: this._config },\n        bubbles: true,\n        composed: true\n      });\n      this.dispatchEvent(event);\n    }\n  }\n\n  // Ê≥®ÂÜåÁºñËæëÂô®ÔºàÈò≤Ê≠¢ÈáçÂ§çÊ≥®ÂÜåÔºâ\n  if (!customElements.get('ha-reachy-mini-card-editor')) {\n    customElements.define('ha-reachy-mini-card-editor', ReachyMini3DCardEditor);\n  }\n\n  // ‰∏ªÂç°ÁâáÁªÑ‰ª∂\n  class ReachyMini3DCard extends HTMLElement {\n    constructor() {\n      super();\n      this.attachShadow({ mode: 'open' });\n      this._frameCount = 0;\n      this._lastDataVersion = -1;\n      this._robotState = {\n        headJoints: null,\n        headPose: null,\n        passiveJoints: null,\n        antennas: [0, 0],\n        dataVersion: 0\n      };\n      this._reconnectAttempts = 0;\n      this._maxReconnectAttempts = 10;\n      this._reconnectDelay = 3000;\n      this._reconnectTimeout = null;\n    }\n\n    static getConfigElement() {\n      return document.createElement('ha-reachy-mini-card-editor');\n    }\n\n    static getStubConfig() {\n      return {\n        daemon_host: 'localhost',\n        daemon_port: 8000,\n        height: 400,\n        enable_passive_joints: true,\n        enable_head_pose: true,\n        background_color: '#f5f5f5',\n        enable_grid: true,\n        camera_distance: 0.5\n      };\n    }\n\n    setConfig(config) {\n      this._config = {\n        daemon_host: 'localhost',\n        daemon_port: 8000,\n        height: 400,\n        enable_passive_joints: true,\n        enable_head_pose: true,\n        background_color: '#f5f5f5',\n        enable_grid: true,\n        camera_distance: 0.5,\n        ...config\n      };\n    }\n\n    getCardSize() {\n      return this._config.height ? this._config.height / 50 : 8;\n    }\n\n    getGridOptions() {\n      // Grid options for sections view (12 columns grid)\n      const height = this._config.height || 400;\n      const rows = Math.ceil(height / 50);\n      return {\n        rows: rows,\n        columns: 6,\n        min_rows: 4,\n        max_rows: 20,\n      };\n    }\n\n    set hass(hass) {\n      // Store Home Assistant instance (required by custom card API)\n      this._hass = hass;\n      // This card doesn't use HA entities directly, but set hass is required\n    }\n\n    async connectedCallback() {\n      this.render();\n      await this.init();\n    }\n\n    render() {\n      this.shadowRoot.innerHTML = `\n      <style>\n        :host { display: block; }\n        ha-card {\n          overflow: hidden;\n          border-radius: var(--ha-card-border-radius, 12px);\n          box-shadow: var(--ha-card-box-shadow, none);\n        }\n        #container {\n          position: relative;\n          width: 100%;\n          height: ${this._config.height}px;\n        }\n        #status {\n          position: absolute;\n          top: 10px;\n          left: 10px;\n          padding: 6px 12px;\n          border-radius: 20px;\n          font-size: 12px;\n          font-weight: 500;\n          color: white;\n          z-index: 10;\n          transition: all 0.3s ease;\n        }\n        .connected { background: #4caf50; }\n        .connecting { background: #ff9800; }\n        .error { background: #f44336; }\n        .loading {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n        #fps-counter {\n          position: absolute;\n          top: 10px;\n          right: 10px;\n          padding: 4px 8px;\n          border-radius: 12px;\n          font-size: 11px;\n          font-weight: 500;\n          color: white;\n          background: rgba(0, 0, 0, 0.6);\n          z-index: 10;\n        }\n      </style>\n      <ha-card>\n        <div id=\"container\">\n          <div id=\"status\" class=\"connecting\">Connecting...</div>\n          <div id=\"fps-counter\">0 FPS</div>\n          <div id=\"loading\" class=\"loading\">\n            <ha-circular-progress indeterminate></ha-circular-progress>\n          </div>\n        </div>\n      </ha-card>\n    `;\n    }\n\n    async init() {\n      try {\n        await this.loadThreeJS();\n        this._setupScene();\n        await this.loadRobot();\n        this.startPolling();\n      } catch (err) {\n        console.error('Init error:', err);\n        this.showError(err.message);\n      }\n    }\n\n    async loadThreeJS() {\n      const basePath = this.getBasePath();\n      \n      // Check if already loaded\n      if (typeof THREE !== 'undefined' && THREE && THREE.WebGLRenderer) {\n        console.log('‚úÖ Three.js already loaded');\n        return;\n      }\n\n      console.log('üì¶ Loading Three.js...');\n      \n      try {\n        // Load Three.js from local file (flat structure in dist/)\n        const threeModule = await import(`${basePath}three.module.js`);\n        window.THREE = threeModule;\n        console.log('‚úÖ Three.js loaded');\n        \n        // Load OrbitControls\n        const orbitControlsModule = await import(`${basePath}OrbitControls.js`);\n        window.OrbitControls = orbitControlsModule.OrbitControls || orbitControlsModule.default;\n        console.log('‚úÖ OrbitControls loaded');\n      } catch (error) {\n        console.error('‚ùå Failed to load Three.js:', error);\n        throw new Error('Failed to load Three.js: ' + error.message);\n      }\n    }\n\n    startPolling() {\n      const { daemon_host, daemon_port } = this._config;\n      const apiUrl = `http://${daemon_host}:${daemon_port}/api/state/full?with_control_mode=true&with_head_joints=true&with_body_yaw=true&with_antenna_positions=true&with_passive_joints=true`;\n      \n      console.log('üîÑ Starting polling:', apiUrl);\n      \n      this._pollingInterval = setInterval(async () => {\n        try {\n          const response = await fetch(apiUrl);\n          if (response.ok) {\n            const data = await response.json();\n            this._processRobotData(data);\n            this.updateStatus('connected', 'Connected');\n          } else {\n            console.error('‚ùå API error:', response.status);\n            this.updateStatus('error', `Error: ${response.status}`);\n          }\n        } catch (err) {\n          console.error('‚ùå Polling error:', err);\n          this.updateStatus('error', 'Connection Failed');\n        }\n      }, 50); // Poll every 50ms (20Hz) like reference project\n    }\n\n    _processRobotData(data) {\n      // head_joints: Array of 7 values [yaw_body, stewart_1, ..., stewart_6]\n      if (data.head_joints && Array.isArray(data.head_joints) && data.head_joints.length >= 7) {\n        this._robotState.headJoints = data.head_joints;\n      }\n      \n      // body_yaw: Single value (same as head_joints[0])\n      if (data.body_yaw !== undefined) {\n        if (!this._robotState.headJoints) {\n          this._robotState.headJoints = [];\n        }\n        this._robotState.headJoints[0] = data.body_yaw;\n      }\n      \n      // head_pose: Object with x, y, z, roll, pitch, yaw\n      if (data.head_pose) {\n        this._robotState.headPose = data.head_pose;\n      }\n      \n      // antennas_position: Array of 2 values [left, right]\n      if (data.antennas_position && Array.isArray(data.antennas_position) && data.antennas_position.length >= 2) {\n        this._robotState.antennas = data.antennas_position;\n      }\n      \n      // passive_joints: Array of 21 values or null\n      if (data.passive_joints && Array.isArray(data.passive_joints) && data.passive_joints.length >= 21) {\n        this._robotState.passiveJoints = data.passive_joints;\n      }\n      \n      this._robotState.dataVersion++;\n      this._updateRobot();\n    }\n\n    _updateRobot() {\n      if (!this._robot) return;\n\n      // Apply head joints\n      if (this._robotState.headJoints) {\n        const joints = this._robotState.headJoints;\n        if (this._robot.joints['yaw_body']) {\n          this._robot.setJointValue('yaw_body', joints[0]);\n        }\n        ['stewart_1', 'stewart_2', 'stewart_3', 'stewart_4', 'stewart_5', 'stewart_6'].forEach((name, i) => {\n          if (this._robot.joints[name]) {\n            this._robot.setJointValue(name, joints[i + 1]);\n          }\n        });\n      }\n\n      // Apply passive joints\n      if (this._config.enable_passive_joints !== false && this._robotState.passiveJoints) {\n        const passiveJoints = this._robotState.passiveJoints;\n        for (let i = 0; i < 21; i++) {\n          const jointName = PASSIVE_JOINT_NAMES[i];\n          if (this._robot.joints[jointName]) {\n            this._robot.setJointValue(jointName, passiveJoints[i]);\n          }\n        }\n      }\n\n      // Apply antennas\n      if (this._robotState.antennas) {\n        const antennas = this._robotState.antennas;\n        if (this._robot.joints['left_antenna']) {\n          this._robot.setJointValue('left_antenna', -antennas[1]);\n        }\n        if (this._robot.joints['right_antenna']) {\n          this._robot.setJointValue('right_antenna', -antennas[0]);\n        }\n      }\n    }\n\n    async loadRobot() {\n      const basePath = this.getBasePath();\n      \n      // Âä®ÊÄÅÂä†ËΩΩ URDFLoader Áõ∏ÂÖ≥Ê®°Âùó (flat structure)\n      await import(`${basePath}URDFClasses.js`);\n      await import(`${basePath}URDFDragControls.js`);\n      \n      const URDFLoaderModule = await import(`${basePath}urdf-loader.js`);\n      const URDFLoader = URDFLoaderModule.default;\n      \n      const loader = new URDFLoader();\n      loader.workingPath = basePath;  // STL files are in meshes/ subdirectory (URDF references meshes/xxx.stl)\n      \n      this._robot = await loader.load(`${basePath}reachy-mini.urdf`);\n      this._scene.add(this._robot);\n\n      // Initialize all joints to zero\n      this._initializeJoints();\n\n      // Hide loading\n      const loading = this.shadowRoot.querySelector('#loading');\n      if (loading) loading.style.display = 'none';\n\n      // Start animation loop\n      this._startAnimationLoop();\n    }\n\n    _initializeJoints() {\n      if (!this._robot || !this._robot.joints) return;\n\n      // Initialize yaw_body\n      if (this._robot.joints['yaw_body']) {\n        this._robot.setJointValue('yaw_body', 0);\n      }\n\n      // Initialize stewart joints\n      ['stewart_1', 'stewart_2', 'stewart_3', 'stewart_4', 'stewart_5', 'stewart_6'].forEach(jointName => {\n        if (this._robot.joints[jointName]) {\n          this._robot.setJointValue(jointName, 0);\n        }\n      });\n\n      // Initialize passive joints\n      PASSIVE_JOINT_NAMES.forEach(jointName => {\n        if (this._robot.joints[jointName]) {\n          this._robot.setJointValue(jointName, 0);\n        }\n      });\n\n      // Initialize antennas\n      ['left_antenna', 'right_antenna'].forEach(jointName => {\n        if (this._robot.joints[jointName]) {\n          this._robot.setJointValue(jointName, 0);\n        }\n      });\n    }\n\n    _setupScene() {\n      const container = this.shadowRoot.querySelector('#container');\n      const canvas = document.createElement('canvas');\n      canvas.style.width = '100%';\n      canvas.style.height = '100%';\n      container.appendChild(canvas);\n      \n      // Scene\n      this._scene = new THREE.Scene();\n      this._scene.background = new THREE.Color(this._config.background_color || '#f5f5f5');\n\n      // Camera\n      this._camera = new THREE.PerspectiveCamera(\n        50,\n        container.clientWidth / this._config.height,\n        0.01,\n        1000\n      );\n      this._camera.position.set(0.3, 0.3, this._config.camera_distance || 0.5);\n\n      // Renderer\n      this._renderer = new THREE.WebGLRenderer({ canvas, antialias: true });\n      this._renderer.setSize(container.clientWidth, this._config.height);\n      this._renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n\n      // Controls\n      this._controls = new OrbitControls(this._camera, canvas);\n      this._controls.enableDamping = true;\n      this._controls.dampingFactor = 0.05;\n      this._controls.minDistance = 0.2;\n      this._controls.maxDistance = 1.5;\n      this._controls.target.set(0, 0.15, 0);\n\n      // Lights\n      this._scene.add(new THREE.AmbientLight(0xffffff, 0.6));\n      \n      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n      directionalLight.position.set(1, 1, 1);\n      this._scene.add(directionalLight);\n      \n      const backLight = new THREE.DirectionalLight(0xffffff, 0.3);\n      backLight.position.set(-1, -1, -1);\n      this._scene.add(backLight);\n\n      // Grid\n      if (this._config.enable_grid !== false) {\n        this._scene.add(new THREE.GridHelper(0.4, 20, 0x888888, 0xcccccc));\n      }\n\n      // FPS counter\n      this._fpsCounter = {\n        frameCount: 0,\n        lastTime: performance.now(),\n        fps: 0\n      };\n    }\n\n    _startAnimationLoop() {\n      // Animation loop\n      const animate = () => {\n        this._animationId = requestAnimationFrame(animate);\n        \n        // Update robot state\n        this._updateRobot();\n        \n        // FPS calculation\n        this._fpsCounter.frameCount++;\n        const currentTime = performance.now();\n        if (currentTime - this._fpsCounter.lastTime >= 1000) {\n          this._fpsCounter.fps = this._fpsCounter.frameCount;\n          this._fpsCounter.frameCount = 0;\n          this._fpsCounter.lastTime = currentTime;\n          \n          const fpsEl = this.shadowRoot.querySelector('#fps-counter');\n          if (fpsEl) {\n            fpsEl.textContent = `${this._fpsCounter.fps} FPS`;\n          }\n        }\n        \n        this._controls.update();\n        this._renderer.render(this._scene, this._camera);\n      };\n      animate();\n    }\n\n    updateStatus(status, message) {\n      const statusEl = this.shadowRoot.querySelector('#status');\n      if (statusEl) {\n        statusEl.className = status;\n        statusEl.textContent = message;\n      }\n    }\n\n    showError(message) {\n      const container = this.shadowRoot.querySelector('#container');\n      if (container) {\n        container.innerHTML = `\n          <div style=\"padding: 20px; color: #f44336;\">Error: ${message}</div>\n        `;\n      }\n    }\n\n    getBasePath() {\n      // Integration static path (registered by __init__.py)\n      return '/reachy_mini_3d_static/';\n    }\n\ndisconnectedCallback() {\n      if (this._animationId) {\n        cancelAnimationFrame(this._animationId);\n        this._animationId = null;\n      }\n      if (this._pollingInterval) {\n        clearInterval(this._pollingInterval);\n        this._pollingInterval = null;\n      }\n      if (this._renderer) {\n        this._renderer.dispose();\n        this._renderer = null;\n      }\n      if (this._scene) {\n        this._scene.clear();\n        this._scene = null;\n      }\n    }\n  }\n\n  // Ê≥®ÂÜå‰∏ªÂç°ÁâáÔºàÈò≤Ê≠¢ÈáçÂ§çÊ≥®ÂÜåÔºâ\n  if (!customElements.get('ha-reachy-mini-card')) {\n    customElements.define('ha-reachy-mini-card', ReachyMini3DCard);\n  }\n\n  // Ê≥®ÂÜåÂà∞ window.customCards ‰ª•‰æøÂú®Âç°ÁâáÈÄâÊã©Âô®‰∏≠ÊòæÁ§∫\n  window.customCards = window.customCards || [];\n  window.customCards.push({\n    type: 'ha-reachy-mini-card',\n    name: 'Reachy Mini 3D Card',\n    description: '3D visualization of Reachy Mini robot',\n    preview: true,\n    documentationURL: 'https://github.com/Desmond-Dong/ha-reachy-mini-card',\n  });\n\n})();"],"names":["PASSIVE_JOINT_NAMES","ReachyMini3DCardEditor","HTMLElement","constructor","super","this","attachShadow","mode","setConfig","config","_config","render","shadowRoot","innerHTML","daemon_host","daemon_port","height","background_color","camera_distance","enable_passive_joints","enable_head_pose","enable_grid","getElementById","addEventListener","e","target","value","dispatchConfig","parseInt","parseFloat","checked","event","CustomEvent","detail","bubbles","composed","dispatchEvent","customElements","get","define","ReachyMini3DCard","_frameCount","_lastDataVersion","_robotState","headJoints","headPose","passiveJoints","antennas","dataVersion","_reconnectAttempts","_maxReconnectAttempts","_reconnectDelay","_reconnectTimeout","getConfigElement","document","createElement","getStubConfig","getCardSize","getGridOptions","rows","Math","ceil","columns","min_rows","max_rows","hass","_hass","connectedCallback","init","loadThreeJS","_setupScene","loadRobot","startPolling","err","console","error","showError","message","basePath","getBasePath","THREE","WebGLRenderer","log","threeModule","import","window","orbitControlsModule","OrbitControls","default","Error","apiUrl","_pollingInterval","setInterval","async","response","fetch","ok","data","json","_processRobotData","updateStatus","status","head_joints","Array","isArray","length","undefined","body_yaw","head_pose","antennas_position","passive_joints","_updateRobot","_robot","joints","setJointValue","forEach","name","i","jointName","loader","URDFLoader","workingPath","load","_scene","add","_initializeJoints","loading","querySelector","style","display","_startAnimationLoop","container","canvas","width","appendChild","Scene","background","Color","_camera","PerspectiveCamera","clientWidth","position","set","_renderer","antialias","setSize","setPixelRatio","min","devicePixelRatio","_controls","enableDamping","dampingFactor","minDistance","maxDistance","AmbientLight","directionalLight","DirectionalLight","backLight","GridHelper","_fpsCounter","frameCount","lastTime","performance","now","fps","animate","_animationId","requestAnimationFrame","currentTime","fpsEl","textContent","update","statusEl","className","disconnectedCallback","cancelAnimationFrame","clearInterval","dispose","clear","customCards","push","type","description","preview","documentationURL"],"mappings":"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"}